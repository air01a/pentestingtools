import hashlib
def sha1(cleartext):
        return hashlib.sha1(cleartext).hexdigest()

#format "salt": "password"
user = {}

source = open("password", "r")
i=0

for line in source.readlines():
        password=line.rstrip()
        result=[]
        for slt in user:
                pwd=user[slt]
                result.append(sha1(slt+password))
                result.append(sha1(password+slt))
                if pwd in result:
                        print "FOUND !!! : PWD / SALT / HASH : %s / %s / %s" %(password,slt,pwd)
        i+=1
        if i%5000 == 0:
                print "Tested %s password" % (str(i))
